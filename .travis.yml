language: node_js
sudo: true
dist: trusty
node_js:
- '5.5'
branches:
  only:
  - master
  - "/^core\\/.+$/"
addons:
  firefox: latest
  apt:
    sources:
    - google-chrome
    packages:
    - google-chrome-stable
cache:
  directories:
  - node_modules
  - bower_components
install:
- export DISPLAY=:99.0
- sh -e /etc/init.d/xvfb start
- du -sh ./node_modules ./bower_components/ || true
- npm config set spin false
- npm config set loglevel http
- npm install
- npm run update-webdriver
script:
- node_modules/.bin/gulp --env=production
- node_modules/.bin/karma start karma.conf.js
- node_modules/.bin/gulp start &
- sleep 3
- node_modules/.bin/protractor protractor.conf.js --browser=firefox
before_deploy:
- sh heroku/pre-deploy.sh
deploy:
  app: angular-see
  provider: heroku
  api_key: mKTIpXwGkjW/upyUihRH93ddGYlC0xrbFQIPe+k9MiYbu1UyrJnEJFgDLBmrmCw2I3jBxUibQw7Q9FuMJFvjBdl0OkdepoWXIMz+9F0ypGWxHZRGC4Rl6QsnBHLEfWsyypXEOVEErhD7SUNRwHHLlbqH1D1ok2oaYR838PmuHJf7fRneiSLTsIAwhSluBh1UEpHkFwvS3GyD7g99dq8OYcBkNzUyPczqSy0tpEvtm5XwH0+NkMDnYzk+AzRNpVhgcvVdGQ0DTuPIU6PEYgMcs+5GV5wsL1xHUQGN/BUYCGGFCYpJ6PaLa1Xb5AKYzBKQ7rjU20WMM+GYruX3xbDuqSHC2Zw6MsLewYMXeoVjL0lFFqc3GuTDxM5fh/9D0uIcaFMvMllE5AG2Y8GxizeMKfkub9dK3LSgTpFlZVyKY+rjNep6C9uZdt2AXDchB5Fy2EMFs0IJL8TwBGkT+f7DSc2NTLz1F1K5qfpOChNVQwM3YgHAe+uam0pEGKwYS4+XKV97zuwfItoRSh2GY68CXTQ+GrL4+p7NAhVVTVJy2F7usbvySwM+NXcN1XBqurc8g167fZiEpahXDMlx9sBYtiFFFcE3/HDqvAOJV+rlGGjj+kt+usmei3M2Y4Y6a1uMkEG1tFT1QebAbYn1g/FHPKDjGJs1gj8YpVMXHS7/a7w=
  on: core/heroku-deployment
