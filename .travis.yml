language: node_js
sudo: true
dist: trusty
node_js:
- '5.5'
branches:
  only:
  - master
  - "/^core\\/.+$/"
addons:
  firefox: latest
  apt:
    sources:
    - google-chrome
    packages:
    - google-chrome-stable
cache:
  directories:
  - node_modules
  - bower_components
install:
- export DISPLAY=:99.0
- sh -e /etc/init.d/xvfb start
- du -sh ./node_modules ./bower_components/ || true
- npm config set spin false
- npm config set loglevel http
- npm install
- npm run update-webdriver
script:
- node_modules/.bin/gulp --env=production
- node_modules/.bin/karma start karma.conf.js
- node_modules/.bin/gulp start &
- sleep 3
- node_modules/.bin/protractor protractor.conf.js --browser=firefox
before_deploy:
- sh heroku/pre-deploy.sh
deploy:
  provider: heroku
  api_key:
    secure: YQxG0GAl8z/lByjmDlE/rzoTaY7xEjVvmC1Fad4eKoKcE3Oy7XeBlTJmQaqYcD06JY81ZgkRVtwy746APCmFcg3i7wkObfs16lqgXEt7+lFT0ZQukAqSS2FoSsvsm9NEkAPHIZxsSDEW2aWkrIXayc7tFuD4F1TiEeJQVo1GkFdVVTks/1oj6XWHHMY+gi8z4kDwnXJZD0B/GYEka8p6+JZGK2UbMJMchliqqtj2LvkPYKYIpUB8QCbJpiND5VVXG3DROCJQbIjnOtT6C5DLyH0QHjFyQmBiMDmX3BBTY1+CIHemCqT78om7TQqIT+iSqz8b7CP9bk8B2k2sKpLZkdpJcA8QQRnHwcEaz3A1hQT1rM58B+4TT6LQeXnTys7vrByrjQYI+somPj9z3cu8guC3wlwiJ15bnJhaXTrgkSgXdq2SsDsm8g1ciJIcKSy2iCziPSq9vhzdFElwdC5ki8c0vAgxl48O6CmQJtfUrT+KRRmG3GAIRE43PSQJ60S2R75/mGOjEpzhA8DDR3wLMSiASdvKTpVIzMAWUJiEFcB9kkOe8Yy/Ybm+wIXdY6UufiVUk4NNwymg02pEBKg7EwcQbhFBKKWWAMKRLKmUJIzlfDHya6zxKBFXRcmFlXEFxmS5xpHQ7Nf/gwMMlx2pD9wOAC9ma2aoLlgN+xMkqsU=
  app: angular-see
  on: core/heroku-deployment
