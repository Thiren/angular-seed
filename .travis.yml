language: node_js
sudo: true
node_js:
- '6'
branches:
  only:
  - master
  - "/^core\\/.+$/"
addons:
  firefox: latest
cache:
  directories:
  - node_modules
  - bower_components
install:
- export DISPLAY=:99.0
- sh -e /etc/init.d/xvfb start
- du -sh ./node_modules ./bower_components/ || true
- npm config set spin false
- npm config set loglevel http
- npm install
- node_modules/.bin/bower install
- npm run update-webdriver
before_script:
- node_modules/.bin/gulp lint
- node_modules/.bin/gulp test:build
- node_modules/.bin/karma start karma.conf.js
script:
- node_modules/.bin/gulp --env=production
after_script:
- node_modules/.bin/gulp start &
- sleep 2
- node_modules/.bin/protractor protractor.conf.js --browser=firefox
befor_deploy:
  - ./deploy-scripts/copy-gitignore.sh
deploy:
  provider: heroku
  api_key:
    secure: JYsXorIhe8uJrZvLIqJ7CCWc3n2Hv7ngGEZ0nGTtF+OI4aEgn/z8hJ0hj8MVq9Kc49FYmoXaUJj9nQE9Kp1jngMEMlKJiPpeDGCiBwWfwVCp42bxWg/FJBHg+/L/rczTSn7vMwN/C0oGcFtOIZPU36d/l4Uqz/7dMxZOG4HMwEplx2xd7DdTXaFCoXp67k+LwhE+qEBnUfZ74v8tigNQSDaKXHFgBmBj1LPkcuj6FGFAMEKoH7qguQbG5LX0OnQslqInsLvRqSG0Ae1Z0iJTsFpRSEV1qQY3ZyWxv6mdLkKpNBtTKxY2oKZPEMeZAEeJkhZaT5WuY90iPC7mcLAnkaDr3ZG0cIXQ4ExHEhGHRglmHJrqKPcLVsVFWc/9WxYUys59dUwhQglzJ8x5ai1LcBiF7LmWFGP3XquMap7n7yFaKyfNGa3lkYO7KoyqhZvSk0GKSXLWX3FDLdrghRnkd3BwcZ3SmuqNYYy++4SB4oj3HaG1OeJPYN3AnkCCP4GS/CbZDs4xKU2tZB5zqzdCjeVutgvh4LuLXEvAkQvsyRq1MEkSKCWiAwwyCbmTMsSoDyhXm3bsama78QB2bjvPE9yBcmgXi9mEqZCZ23cCYldS0GtEG/BAjPAQ+AA+QkHRZCrauk9ru67U707LhiLTBN2Si8lDGvmAoYBaBZvIRXU=
  strategy: git
  skip_cleanup: true
  app: angular-see
  on:
    repo: thiren/angular-seed
    branch: core/heroku-deployment
